<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>uriparser: uriparser</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">uriparser<span id="projectnumber">&#160;0.9.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('index.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">uriparser </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="SEC_TOC"></a>
Table of Contents</h1>
<ul>
<li><a href="#intro">Introduction</a></li>
<li>Algorithms and Examples<ul>
<li><a href="#parsing">Parsing URIs</a> (from string to object)</li>
<li><a href="#recomposition">Recomposing URIs</a> (from object back to string)</li>
<li><a href="#resolution">Resolving References</a></li>
<li><a href="#shortening">Creating References</a></li>
<li><a href="#filenames">Filenames and URIs</a></li>
<li><a href="#normalization">Normalizing URIs</a></li>
<li><a href="#querystrings">Working with Query Strings</a></li>
</ul>
</li>
<li><a href="#chartypes">Narrow Strings and Wide Strings</a></li>
<li><a href="#autoconf">Autoconf Check</a></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="intro"></a>
Introduction</h1>
<p>Welcome to the short uriparser integration tutorial. It is intended to answer upcoming questions and to shed light where function prototypes alone are not enough. Please drop me a line if you need further assistance and I will see what I can do for you. Good luck with uriparser!</p>
<h2 class="doxsection"><a class="anchor" id="parsing"></a>
Parsing URIs (from string to object)</h2>
<p>Parsing a URI with uriparser looks like this:</p>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="Uri_8h.html#a3f13cb47b90887ff975cd11b6cd98702">UriUriA</a> uri;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> uriString = <span class="stringliteral">&quot;file:///home/user/song.mp3&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> * errorPos;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="Uri_8h.html#a616c892b6bb7ad2dba27b9314bcd90c0">uriParseSingleUriA</a>(&amp;uri, uriString, &amp;errorPos) != URI_SUCCESS) {</div>
<div class="line">    <span class="comment">/* Failure (no need to call uriFreeUriMembersA) */</span></div>
<div class="line">    ...</div>
<div class="line">    <span class="keywordflow">return</span> ...;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Success */</span></div>
<div class="line">...</div>
<div class="line">uriFreeUriMembersA(&amp;uri);</div>
<div class="ttc" id="aUri_8h_html_a3f13cb47b90887ff975cd11b6cd98702"><div class="ttname"><a href="Uri_8h.html#a3f13cb47b90887ff975cd11b6cd98702">UriUriA</a></div><div class="ttdeci">struct UriUriStructA UriUriA</div></div>
<div class="ttc" id="aUri_8h_html_a616c892b6bb7ad2dba27b9314bcd90c0"><div class="ttname"><a href="Uri_8h.html#a616c892b6bb7ad2dba27b9314bcd90c0">uriParseSingleUriA</a></div><div class="ttdeci">int uriParseSingleUriA(UriUriA *uri, const char *text, const char **errorPos)</div></div>
</div><!-- fragment --><p>While the URI object (UriUriA) holds information about the recognized parts of the given URI string, in case of <code>URI_ERROR_SYNTAX</code>, <code>errorPos</code> points to the first character starting invalid syntax.</p>
<h2 class="doxsection"><a class="anchor" id="recomposition"></a>
Recomposing URIs (from object back to string)</h2>
<p>According to <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-5.3" target="_blank">RFC 3986</a> gluing parts of a URI together to form a string is called recomposition. Before we can recompose a URI object we have to know how much space the resulting string will take:</p>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="Uri_8h.html#a3f13cb47b90887ff975cd11b6cd98702">UriUriA</a> uri;</div>
<div class="line"><span class="keywordtype">char</span> * uriString;</div>
<div class="line"><span class="keywordtype">int</span> charsRequired;</div>
<div class="line">...</div>
<div class="line">if (<a class="code hl_function" href="Uri_8h.html#ae57c60e8166c44163af6d0434329fe73">uriToStringCharsRequiredA</a>(&amp;uri, &amp;charsRequired) != URI_SUCCESS) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="line">charsRequired++;</div>
<div class="ttc" id="aUri_8h_html_ae57c60e8166c44163af6d0434329fe73"><div class="ttname"><a href="Uri_8h.html#ae57c60e8166c44163af6d0434329fe73">uriToStringCharsRequiredA</a></div><div class="ttdeci">int uriToStringCharsRequiredA(const UriUriA *uri, int *charsRequired)</div></div>
</div><!-- fragment --><p>Now we can tell uriToStringA() to write the string to a given buffer:</p>
<div class="fragment"><div class="line">uriString = malloc(charsRequired * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><span class="keywordflow">if</span> (uriString == NULL) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="Uri_8h.html#a4a9539cfdd85866a1ef6916c631f8bc2">uriToStringA</a>(uriString, &amp;uri, charsRequired, NULL) != URI_SUCCESS) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="ttc" id="aUri_8h_html_a4a9539cfdd85866a1ef6916c631f8bc2"><div class="ttname"><a href="Uri_8h.html#a4a9539cfdd85866a1ef6916c631f8bc2">uriToStringA</a></div><div class="ttdeci">int uriToStringA(char *dest, const UriUriA *uri, int maxChars, int *charsWritten)</div></div>
</div><!-- fragment --><dl class="section remark"><dt>Remarks</dt><dd>Incrementing <code>charsRequired</code> by 1 is required since uriToStringCharsRequiredA() returns the length of the string as strlen() does, but uriToStringA() works with the number of maximum characters to be written <b>including</b> the zero-terminator.</dd></dl>
<h2 class="doxsection"><a class="anchor" id="resolution"></a>
Resolving References</h2>
<p><a href="https://datatracker.ietf.org/doc/html/rfc3986#section-5" target="_blank">Reference Resolution</a> is the process of turning a (relative) URI reference into an absolute URI by applying a base URI to it. In code it looks like this:</p>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="Uri_8h.html#a3f13cb47b90887ff975cd11b6cd98702">UriUriA</a> absoluteDest;</div>
<div class="line"><a class="code hl_typedef" href="Uri_8h.html#a3f13cb47b90887ff975cd11b6cd98702">UriUriA</a> relativeSource;</div>
<div class="line"><a class="code hl_typedef" href="Uri_8h.html#a3f13cb47b90887ff975cd11b6cd98702">UriUriA</a> absoluteBase;</div>
<div class="line">...</div>
<div class="line"><span class="comment">/* relativeSource holds &quot;../TWO&quot; now */</span></div>
<div class="line"><span class="comment">/* absoluteBase holds &quot;file:///one/two/three&quot; now */</span></div>
<div class="line">if (<a class="code hl_function" href="Uri_8h.html#a4bcf2a1fa28bb86443f2b61561e692a7">uriAddBaseUriA</a>(&amp;absoluteDest, &amp;relativeSource, &amp;absoluteBase) != URI_SUCCESS) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    <a class="code hl_function" href="Uri_8h.html#aa5f2edbe34fcde379ccca4fe3fadcd48">uriFreeUriMembersA</a>(&amp;absoluteDest);</div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="line"><span class="comment">/* absoluteDest holds &quot;file:///one/TWO&quot; now */</span></div>
<div class="line">...</div>
<div class="line">uriFreeUriMembersA(&amp;absoluteDest);</div>
<div class="ttc" id="aUri_8h_html_a4bcf2a1fa28bb86443f2b61561e692a7"><div class="ttname"><a href="Uri_8h.html#a4bcf2a1fa28bb86443f2b61561e692a7">uriAddBaseUriA</a></div><div class="ttdeci">int uriAddBaseUriA(UriUriA *absoluteDest, const UriUriA *relativeSource, const UriUriA *absoluteBase)</div></div>
<div class="ttc" id="aUri_8h_html_aa5f2edbe34fcde379ccca4fe3fadcd48"><div class="ttname"><a href="Uri_8h.html#aa5f2edbe34fcde379ccca4fe3fadcd48">uriFreeUriMembersA</a></div><div class="ttdeci">void uriFreeUriMembersA(UriUriA *uri)</div></div>
</div><!-- fragment --><dl class="section remark"><dt>Remarks</dt><dd>uriAddBaseUriA() does not normalize the resulting URI. Usually you might want to pass it through uriNormalizeSyntaxA() after.</dd></dl>
<h2 class="doxsection"><a class="anchor" id="shortening"></a>
Creating References</h2>
<p>Reference Creation is the inverse process of Reference Resolution: A common base URI is &quot;subtracted&quot; from an absolute URI to make a (relative) reference. If the base URI is not common the remaining URI will still be absolute, i.e. will carry a scheme</p>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="Uri_8h.html#a3f13cb47b90887ff975cd11b6cd98702">UriUriA</a> dest;</div>
<div class="line"><a class="code hl_typedef" href="Uri_8h.html#a3f13cb47b90887ff975cd11b6cd98702">UriUriA</a> absoluteSource;</div>
<div class="line"><a class="code hl_typedef" href="Uri_8h.html#a3f13cb47b90887ff975cd11b6cd98702">UriUriA</a> absoluteBase;</div>
<div class="line">...</div>
<div class="line"><span class="comment">/* absoluteSource holds &quot;file:///one/TWO&quot; now */</span></div>
<div class="line"><span class="comment">/* absoluteBase holds &quot;file:///one/two/three&quot; now */</span></div>
<div class="line">if (<a class="code hl_function" href="Uri_8h.html#a4a14ec47aeeadd9ff7a5e381a10234a0">uriRemoveBaseUriA</a>(&amp;dest, &amp;absoluteSource, &amp;absoluteBase, URI_FALSE) != URI_SUCCESS) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    <a class="code hl_function" href="Uri_8h.html#aa5f2edbe34fcde379ccca4fe3fadcd48">uriFreeUriMembersA</a>(&amp;dest);</div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="line"><span class="comment">/* dest holds &quot;../TWO&quot; now */</span></div>
<div class="line">...</div>
<div class="line">uriFreeUriMembersA(&amp;dest);</div>
<div class="ttc" id="aUri_8h_html_a4a14ec47aeeadd9ff7a5e381a10234a0"><div class="ttname"><a href="Uri_8h.html#a4a14ec47aeeadd9ff7a5e381a10234a0">uriRemoveBaseUriA</a></div><div class="ttdeci">int uriRemoveBaseUriA(UriUriA *dest, const UriUriA *absoluteSource, const UriUriA *absoluteBase, UriBool domainRootMode)</div></div>
</div><!-- fragment --><p>The fourth parameter is the domain root mode. With <code>URI_FALSE</code> as above this will produce URIs relative to the base URI. With <code>URI_TRUE</code> the resulting URI will be relative to the domain root instead, e.g. &quot;/one/TWO&quot; in this case.</p>
<h2 class="doxsection"><a class="anchor" id="filenames"></a>
Filenames and URIs</h2>
<p>Converting filenames to and from URIs works on strings directly, i.e. without creating an URI object.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> absFilename = <span class="stringliteral">&quot;E:\\Documents and Settings&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> bytesNeeded = 8 + 3 * strlen(absFilename) + 1;</div>
<div class="line"><span class="keywordtype">char</span> * absUri = malloc(bytesNeeded * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="Uri_8h.html#a4a071c1c4867b49b122dc4fcb1d3021a">uriWindowsFilenameToUriStringA</a>(absFilename, absUri) != URI_SUCCESS) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    free(absUri);</div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="line"><span class="comment">/* absUri is &quot;file:///E:/Documents%20and%20Settings&quot; now */</span></div>
<div class="line">...</div>
<div class="line">free(absUri);</div>
<div class="ttc" id="aUri_8h_html_a4a071c1c4867b49b122dc4fcb1d3021a"><div class="ttname"><a href="Uri_8h.html#a4a071c1c4867b49b122dc4fcb1d3021a">uriWindowsFilenameToUriStringA</a></div><div class="ttdeci">int uriWindowsFilenameToUriStringA(const char *filename, char *uriString)</div></div>
</div><!-- fragment --><p>Conversion works ..</p><ul>
<li>for relative or absolute values,</li>
<li>in both directions (filenames &lt;&ndash;&gt; URIs) and</li>
<li>with Unix and Windows filenames.</li>
</ul>
<p>All you have to do is to choose the right function for the task and allocate the required space (in characters) for the target buffer. Let me present you an overview:</p>
<ul>
<li>Filename &ndash;&gt; URI<ul>
<li>uriUnixFilenameToUriStringA()<br  />
 Space required: [<b>7</b> +] 3 * len(filename) + 1</li>
<li>uriWindowsFilenameToUriStringA()<br  />
 Space required: [<b>8</b> +] 3 * len(filename) + 1</li>
</ul>
</li>
<li>URI &ndash;&gt; filename<ul>
<li>uriUriStringToUnixFilenameA()<br  />
 Space required: len(uriString) + 1 [- <b>7]</b></li>
<li>uriUriStringToWindowsFilenameA()<br  />
 Space required: len(uriString) + 1 [- <b>8]</b></li>
</ul>
</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="normalization"></a>
Normalizing URIs</h2>
<p>Sometimes we come across unnecessarily long URIs like &quot;http<b></b>://example.org/one/two/../../one&quot;. The algorithm we can use to shorten this URI down to &quot;http<b></b>://example.org/one&quot; is called <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-6.2.2" target="_blank">Syntax-Based Normalization</a>. Note that normalizing a URI does more than just &quot;stripping dot segments&quot;. Please have a look at <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-6.2.2" target="_blank">Section 6.2.2 of RFC 3986</a> for the full description.</p>
<p>As we asked uriToStringCharsRequiredA() for the required space when converting a URI object back to a string, we can ask uriNormalizeSyntaxMaskRequiredA() for the parts of a URI that require normalization and then pass this normalization mask to uriNormalizeSyntaxExA():</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dirtyParts = <a class="code hl_function" href="Uri_8h.html#a8de8c90c3655e547cddcd50c663587fb">uriNormalizeSyntaxMaskRequiredA</a>(&amp;uri);</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="Uri_8h.html#abfcb66bec6bb0066fb086174692d5710">uriNormalizeSyntaxExA</a>(&amp;uri, dirtyParts) != URI_SUCCESS) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="ttc" id="aUri_8h_html_a8de8c90c3655e547cddcd50c663587fb"><div class="ttname"><a href="Uri_8h.html#a8de8c90c3655e547cddcd50c663587fb">uriNormalizeSyntaxMaskRequiredA</a></div><div class="ttdeci">unsigned int uriNormalizeSyntaxMaskRequiredA(const UriUriA *uri)</div></div>
<div class="ttc" id="aUri_8h_html_abfcb66bec6bb0066fb086174692d5710"><div class="ttname"><a href="Uri_8h.html#abfcb66bec6bb0066fb086174692d5710">uriNormalizeSyntaxExA</a></div><div class="ttdeci">int uriNormalizeSyntaxExA(UriUriA *uri, unsigned int mask)</div></div>
</div><!-- fragment --><p>If you don't want to normalize all parts of the URI you can pass a custom mask as well:</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> normMask = <a class="code hl_enumvalue" href="UriBase_8h.html#ac0a876ae3fbf22bdfa8d3e4a24838400aed80a4777751564b865f26940169fc23">URI_NORMALIZE_SCHEME</a> | <a class="code hl_enumvalue" href="UriBase_8h.html#ac0a876ae3fbf22bdfa8d3e4a24838400ab5268c99bba09a7624fc98f0780dc618">URI_NORMALIZE_USER_INFO</a>;</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="Uri_8h.html#abfcb66bec6bb0066fb086174692d5710">uriNormalizeSyntaxExA</a>(&amp;uri, normMask) != URI_SUCCESS) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="ttc" id="aUriBase_8h_html_ac0a876ae3fbf22bdfa8d3e4a24838400ab5268c99bba09a7624fc98f0780dc618"><div class="ttname"><a href="UriBase_8h.html#ac0a876ae3fbf22bdfa8d3e4a24838400ab5268c99bba09a7624fc98f0780dc618">URI_NORMALIZE_USER_INFO</a></div><div class="ttdeci">@ URI_NORMALIZE_USER_INFO</div><div class="ttdef"><b>Definition</b> UriBase.h:183</div></div>
<div class="ttc" id="aUriBase_8h_html_ac0a876ae3fbf22bdfa8d3e4a24838400aed80a4777751564b865f26940169fc23"><div class="ttname"><a href="UriBase_8h.html#ac0a876ae3fbf22bdfa8d3e4a24838400aed80a4777751564b865f26940169fc23">URI_NORMALIZE_SCHEME</a></div><div class="ttdeci">@ URI_NORMALIZE_SCHEME</div><div class="ttdef"><b>Definition</b> UriBase.h:182</div></div>
</div><!-- fragment --><p>Please see UriNormalizationMaskEnum for the complete set of flags.</p>
<p>On the other hand calling plain uriNormalizeSyntaxA() (without the &quot;Ex&quot;) saves you thinking about single parts, as it queries uriNormalizeSyntaxMaskRequiredA() internally:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="Uri_8h.html#a50176d4c0c0fb7d40e0e4990d0c7d7bf">uriNormalizeSyntaxA</a>(&amp;uri) != URI_SUCCESS) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="ttc" id="aUri_8h_html_a50176d4c0c0fb7d40e0e4990d0c7d7bf"><div class="ttname"><a href="Uri_8h.html#a50176d4c0c0fb7d40e0e4990d0c7d7bf">uriNormalizeSyntaxA</a></div><div class="ttdeci">int uriNormalizeSyntaxA(UriUriA *uri)</div></div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="querystrings"></a>
Working with Query Strings</h1>
<p><a href="https://datatracker.ietf.org/doc/html/rfc3986" target="_blank">RFC 3986</a> itself does not understand the query part of a URI as a list of key/value pairs. But HTML 2.0 does and defines a media type <em>application/x-www-form-urlencoded</em> in in <a href="https://datatracker.ietf.org/doc/html/rfc1866#section-8.2.1" target="blank">section 8.2.1</a> of <a href="https://datatracker.ietf.org/doc/html/rfc1866" target="blank">RFC 1866</a>. uriparser allows you to dissect (or parse) a query string into unescaped key/value pairs and back.</p>
<p>To dissect the query part of a just-parsed URI you could write code like this:</p>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="Uri_8h.html#a3f13cb47b90887ff975cd11b6cd98702">UriUriA</a> uri;</div>
<div class="line"><a class="code hl_typedef" href="Uri_8h.html#a5441622cbc7a14fa53fd29e6fa01a5a8">UriQueryListA</a> * queryList;</div>
<div class="line"><span class="keywordtype">int</span> itemCount;</div>
<div class="line">...</div>
<div class="line">if (<a class="code hl_function" href="Uri_8h.html#a395240e558a980019bf02cc7518ee524">uriDissectQueryMallocA</a>(&amp;queryList, &amp;itemCount, uri.<a class="code hl_variable" href="structUriUriStructA.html#acb555eb399898672c7b069da0f444157">query</a>.<a class="code hl_variable" href="structUriTextRangeStructA.html#a6f1e1048b5e74fe6c7a680ff99138f68">first</a>,</div>
<div class="line">        uri.<a class="code hl_variable" href="structUriUriStructA.html#acb555eb399898672c7b069da0f444157">query</a>.<a class="code hl_variable" href="structUriTextRangeStructA.html#a86aea0aab8d5ee912c3b260bdd9af67e">afterLast</a>) != URI_SUCCESS) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="line">...</div>
<div class="line">uriFreeQueryListA(queryList);</div>
<div class="ttc" id="aUri_8h_html_a395240e558a980019bf02cc7518ee524"><div class="ttname"><a href="Uri_8h.html#a395240e558a980019bf02cc7518ee524">uriDissectQueryMallocA</a></div><div class="ttdeci">int uriDissectQueryMallocA(UriQueryListA **dest, int *itemCount, const char *first, const char *afterLast)</div></div>
<div class="ttc" id="aUri_8h_html_a5441622cbc7a14fa53fd29e6fa01a5a8"><div class="ttname"><a href="Uri_8h.html#a5441622cbc7a14fa53fd29e6fa01a5a8">UriQueryListA</a></div><div class="ttdeci">struct UriQueryListStructA UriQueryListA</div></div>
<div class="ttc" id="astructUriTextRangeStructA_html_a6f1e1048b5e74fe6c7a680ff99138f68"><div class="ttname"><a href="structUriTextRangeStructA.html#a6f1e1048b5e74fe6c7a680ff99138f68">UriTextRangeStructA::first</a></div><div class="ttdeci">const char * first</div><div class="ttdef"><b>Definition</b> Uri.h:334</div></div>
<div class="ttc" id="astructUriTextRangeStructA_html_a86aea0aab8d5ee912c3b260bdd9af67e"><div class="ttname"><a href="structUriTextRangeStructA.html#a86aea0aab8d5ee912c3b260bdd9af67e">UriTextRangeStructA::afterLast</a></div><div class="ttdeci">const char * afterLast</div><div class="ttdef"><b>Definition</b> Uri.h:335</div></div>
<div class="ttc" id="astructUriUriStructA_html_acb555eb399898672c7b069da0f444157"><div class="ttname"><a href="structUriUriStructA.html#acb555eb399898672c7b069da0f444157">UriUriStructA::query</a></div><div class="ttdeci">UriTextRangeA query</div><div class="ttdef"><b>Definition</b> Uri.h:385</div></div>
</div><!-- fragment --><dl class="section remark"><dt>Remarks</dt><dd><ul>
<li><code>NULL</code> in the <code>value</code> member means there was <b>no</b> '=' in the item text as with "?abc&amp;def".</li>
<li>An empty string in the <code>value</code> member means there was '=' in the item as with "?abc=&amp;def".</li>
</ul>
</dd></dl>
<p>To compose a query string from a query list you could write code like this:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> charsRequired;</div>
<div class="line"><span class="keywordtype">int</span> charsWritten;</div>
<div class="line"><span class="keywordtype">char</span> * queryString;</div>
<div class="line">...</div>
<div class="line">if (<a class="code hl_function" href="Uri_8h.html#a7fd4395b984b9d9519ee2d2aba186613">uriComposeQueryCharsRequiredA</a>(queryList, &amp;charsRequired) != URI_SUCCESS) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="line">queryString = malloc((charsRequired + 1) * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><span class="keywordflow">if</span> (queryString == NULL) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="Uri_8h.html#a5d79be075b94fd3292844feb107e0b75">uriComposeQueryA</a>(queryString, queryList, charsRequired + 1, &amp;charsWritten) != URI_SUCCESS) {</div>
<div class="line">    <span class="comment">/* Failure */</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="line">...</div>
<div class="line">free(queryString);</div>
<div class="ttc" id="aUri_8h_html_a5d79be075b94fd3292844feb107e0b75"><div class="ttname"><a href="Uri_8h.html#a5d79be075b94fd3292844feb107e0b75">uriComposeQueryA</a></div><div class="ttdeci">int uriComposeQueryA(char *dest, const UriQueryListA *queryList, int maxChars, int *charsWritten)</div></div>
<div class="ttc" id="aUri_8h_html_a7fd4395b984b9d9519ee2d2aba186613"><div class="ttname"><a href="Uri_8h.html#a7fd4395b984b9d9519ee2d2aba186613">uriComposeQueryCharsRequiredA</a></div><div class="ttdeci">int uriComposeQueryCharsRequiredA(const UriQueryListA *queryList, int *charsRequired)</div></div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="chartypes"></a>
Narrow Strings and Wide Strings</h1>
<p>uriparser comes with two versions of every structure and function: one handling narrow strings (<code>char *</code>) and one working with wide strings (<code>wchar_t *</code>), for instance</p><ul>
<li>uriParseSingleUriA() for <code>char *</code></li>
<li>uriParseSingleUriW() for <code>wchar_t *</code>.</li>
</ul>
<p>This tutorial only shows the usage of the narrow string editions but their wide string counterparts work in the very same way.</p>
<h1 class="doxsection"><a class="anchor" id="autoconf"></a>
Autoconf Check</h1>
<p>You can use the code below to make <code>./configure</code> test for presence of uriparser 0.9.0 or later.</p>
<div class="fragment"><pre class="fragment">PKG_CHECK_MODULES([URIPARSER], [liburiparser &gt;= 0.9.0], [], [])</pre></div> </div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
